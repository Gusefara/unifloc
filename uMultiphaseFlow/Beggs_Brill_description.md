####Гидравлическая корреляция Беггз и Брилл
Все формулы, требуемые для методики и реализованные на ** unifloc**
Источник:
Брилл Д. П., Мукерджи Х. Многофазный поток в скважинах. – 2006.

#####Предварительные расчеты
Объемные дебиты нефти, воды и газа:
$$
q_o = q_{o_{н.у.}} B_o
$$
$$
q_w = q_{w_{н.у.}} B_w
$$
$$
q_g = (q_{g_{н.у.}} - q_{o_{н.у.}}R_{s}- q_{w_{н.у.}}R_{sw} ) B_g
$$
Объемное содержание жидкости при отсутсвии проскальзывания:
$$
\lambda_L = \frac{q_L}{q_L + q_g}
$$
Уровень обводненности по дебитам фаз в условиях пласта:
$$
f_w = \frac{q_w}{q_w + q_o}
$$
Поперечное сечение трубы:
$$
A_p = \frac{\pi d^2}{4}
$$
Приведенные скорости жидкости и газа:
$$
v_{SL} = \frac{q_L}{A_p}
$$
$$
v_{Sg} = \frac{q_g}{A_p}
$$
Общая скорость смеси:
$$
v_m = \frac{q_L + q_g}{A_p} = v_{SL} + v_{Sg}
$$
Свойства флюидов, выраженные аддитивно, без проскальзывания воды и нефти
$$
\rho_L = \rho_o (1 - f_w) + \rho_w f_w
$$
$$
\sigma_L = \sigma_o (1 - f_w) + \sigma_w f_w
$$
$$
\mu_L = \mu_o (1 - f_w) + \mu_w f_w
$$
Свойства газожидкостной смеси:
$$
\mu_n = \mu_L \lambda_L + \mu_g ( 1 - \lambda_L)
$$
$$
\rho_s = \rho_L H_L + \rho_g ( 1 - H_L)
$$
$$
\rho_n = \rho_L \lambda_L + \rho_g ( 1 - \lambda_L)
$$




#####Прогнозирование режимов потока
Число Фруда для расчета границ переходных режимов потока и объемного содержания жидкости без учета эффекта проскальзывания:
$$
N_{Fr}=\frac{v_{m}^{2}}{gd}
$$
Переходные границы режимов потока для модифицированной карты вычисляются по формулам:
$$ L_1 = 316 \lambda_{L}^{0.302} $$

$$ L_2 = 0.000925 \lambda_{L}^{-2.468}$$

$$ L_3 = 0.10 \lambda_{L}^{-1.452}$$

$$ L_4 = 0.5 \lambda_{L}^{-6.738} $$

#####Неравенства для определения режима потока:
Разделенный режим:
$$ \lambda_{L} < 0.01 $$
и
$$ N_{Fr} < L_1$$
или 
$$ \lambda_{L} \geq 0.01  $$  
и 
$$ N_{Fr} < L_2$$
Переходный режим:
$$ \lambda_{L} \geq 0.01  $$  
и
$$  L_2 \leq N_{Fr} < L_3$$
Прерывистый режим:
$$ 0.01 \leq \lambda_{L} < 0.4$$
и 
$$ L_3 < N_{Fr} \leq L_1 $$
или 
$$ \lambda_{L} \geq 0,4  $$ 
и
$$ L_3 < N_{Fr} \leq L_4 $$
Распределенный режим:
$$ \lambda_{L} < 0,4  $$ 
и
$$  N_{Fr} \geq L_1 $$
или
$$ \lambda_{L} \geq 0.4  $$ 
и
$$  N_{Fr} > L_4 $$

Эмпирические коэффициенты для объемного содержания жидкости в горизонтальных режимах потока:

| Режим потока       | a | b | c |
| :-------------: |:--:| :----:|
| Расслоенный     | 0.980    | 0.4846 | 0.0868 |
| Прерывистый   |  0.855   | 0.5351 | 0.0173 |
| Распределенный  |  1.065    | 0.5824 | 0.0609 |
Объемное содержание жидкости в горизонтальной трубе:
$$ H_{L(0)} = \frac{a\lambda_{L}^{b}}{N_{Fr}^{c}}$$
при ограничении:
$$ H_{L(0)} \geq \lambda_L$$
Объемное содержание жидкости с поправкой на угол наклона трубы:
$$ H_{L(\theta)} = H_{L(0)} * \psi $$
Поправочный коэффициент на угол наклона трубы:
$$ \psi = 1 + C[sin (1.8 \theta) - 0.333 sin^3(1.8 \theta)$$
где:
$$ (1 - \lambda_L) ln(e\lambda_{L}^fN_{Lv}^gN_{Fr}^h)$$
при этом показатель скорости жидкости по Дансу и Росу:
$$
N_{Lv} = v_{SL} (\frac{\rho_L}{g \sigma_L})^{1/4} 
$$
а коэффициенты e,f,g,h определяются по таблице:

| Режим потока       | e | f | g | h
| :-------------: |:--:| :----:|
| Расслоенный в напр. снизу вверх    | 0.011    | -3.7680 |3.5390 | -1.6140
| Прерывистый в напр. снизу вверх   |  2.960   | 0.305 | -0.4473 | 0.0978
| Распределенный в напр. снизу вверх|  Нет | поправки | С = 0 |
| Все режимы в напр. снизу вверх| 4.700    | -0.3692 | 0.1244 | -0.5056

Если режим потока соответствует переходной зоне, необходимо интерполировать значения объемного содержания жидкости для расслоенного и прерывистого режимов потока:
$$ H_{L(\theta)_{перех.}} = AH_{L(\theta)_{раздел.}} + (1-A)H_{L(\theta)_{прерывист.}}$$
где:
$$ A = \frac{L_3 - N_{Fr}}{L_3 - L_2} $$

#####Прогнозирование коэффициента трения
Значения нормирующего коэффициента трения определяют по кривой для гладкой трубы на диаграмме Муди, при этом число Рейнольдса вычисляется по формуле:
$$ 
N_{Re} = \frac{\rho_nv_md}{\mu_n} 
$$
где:
$$
\mu_n = \mu_L*\lambda_L + \mu_g(1-\lambda_L)
$$
Коэффициент трения двухфазного потока с поправкой Беггза и Брилла:
$$
f = f_n e^s
$$
где:
$$
s = \frac{ln(y)}{-0.0523+3.182ln(y)-0.8725(ln(y))^2+0.01853(ln(y))^4}
$$
$$
y = \frac{\lambda_L}{[H_{L(\theta)}]^2}
$$
при следующих ограничениях:

$$
y = 1 \to s = 0
$$
$$
1 < y < 1.2 \to s = ln(2.2y - 1.2)
$$

#####Итоговая функция
Градиент давления в наклонной трубе можно рассчитать по формуле:
$$
\frac{dp}{dL} = \frac{\frac{f\rho_nv_m^2}{2d}+\rho_sgsin\theta}{1 -E_k}
$$
где:
$$
\rho_s=\rho_L H_{L(\theta)}+\rho_g[1-H_{L(\theta)}]
$$
а формула для обезразмеренной кинетической энергии выглядит так:
$$
E_k = \frac{v_mv_{Sg}\rho_n}{p}
$$
#####Модификации метода
Пэйн и др. установили, что в методе Беггза и Брилла неверно был определен коэффициент трения. Нужно определять нормирующий коэффициент трения с учетом некоторой шероховатости трубы (по диаграмме Муди). 
Также данными исследователями были предложены поправочные коэффициенты:

$$
\theta > 0 \to H_{L(\theta)} = 0.924 H_{L(\theta)}
$$
$$
\theta < 0 \to H_{L(\theta)} = 0.685 H_{L(\theta)}
$$



